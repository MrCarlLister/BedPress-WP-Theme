"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Carousel=function(){function e(t){_classCallCheck(this,e),this.board=t,this.push(),this.push(),this.handle()}return _createClass(e,[{key:"handle",value:function(){var e=this;if(this.cards=this.board.querySelectorAll(".card"),this.topCard=this.cards[this.cards.length-1],this.nextCard=this.cards[this.cards.length-2],0<this.cards.length){var a=0;Array.from(this.cards).forEach(function(t){t.offsetHeight>a&&(a=t.offsetHeight),t.style.transform="translateX(-48%) translateY(-48%) rotate(0deg) rotateY(0deg) scale(1)"}),this.board.style.height=a+"px",this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)",this.hammer&&this.hammer.destroy(),this.hammer=new Hammer(this.topCard),this.hammer.add(new Hammer.Tap),this.hammer.add(new Hammer.Pan({position:Hammer.position_ALL,threshold:0})),this.hammer.on("tap",function(t){e.onTap(t)}),this.hammer.on("pan",function(t){e.onPan(t)})}}},{key:"onTap",value:function(t){var e=this,a=15*((t.center.x-t.target.getBoundingClientRect().left)/t.target.clientWidth<.05?-1:1);this.topCard.style.transition="transform 100ms ease-out",this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY("+a+"deg) scale(1)",setTimeout(function(){e.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)"},100)}},{key:"onPan",value:function(t){var e=this;if(!this.isPanning){this.isPanning=!0,this.topCard.style.transition=null,this.nextCard&&(this.nextCard.style.transition=null);var a=window.getComputedStyle(this.topCard).transform.match(/^matrix\((.+)\)$/);this.startPosX=a?parseFloat(a[1].split(", ")[4]):0,this.startPosY=a?parseFloat(a[1].split(", ")[5]):0;var r=this.topCard.getBoundingClientRect();this.isDraggingFrom=t.center.y-r.top>this.topCard.clientHeight/2?-1:1}var s=t.deltaX+this.startPosX,i=t.deltaY+this.startPosY,n=t.deltaX/this.board.clientWidth,o=t.deltaY/this.board.clientHeight,l=t.deltaX<0?-1:1,h=this.isDraggingFrom*l*Math.abs(n)*45,d=(95+5*Math.abs(n))/100;if(this.topCard.style.transform="translateX("+s+"px) translateY("+i+"px) rotate("+h+"deg) rotateY(0deg) scale(1)",this.nextCard&&(this.nextCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale("+d+")"),t.isFinal){var c=this.isPanning=!1;this.topCard.style.transition="transform 200ms ease-out",this.nextCard&&(this.nextCard.style.transition="transform 100ms linear"),.25<n&&t.direction==Hammer.DIRECTION_RIGHT?(c=!0,s=this.board.clientWidth):n<-.25&&t.direction==Hammer.DIRECTION_LEFT?(c=!0,s=-(this.board.clientWidth+this.topCard.clientWidth)):o<-.25&&t.direction==Hammer.DIRECTION_UP&&(c=!0,i=-(this.board.clientHeight+this.topCard.clientHeight)),c?(this.topCard.style.transform="translateX("+s+"px) translateY("+i+"px) rotate("+h+"deg)",setTimeout(function(){e.board.prepend(e.topCard),e.push(),e.handle()},200)):(this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)",this.nextCard&&(this.nextCard.style.transform="translateX(-48%) translateY(-48%) rotate(0deg) rotateY(0deg) scale(0.95)"))}}},{key:"push",value:function(){}}]),e}(),board=document.querySelector("#board"),carousel=new Carousel(board);